<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>API测试页面</title>
    <link href="css/zui.css" rel="stylesheet" />
    <style type="text/css">
        html, body {
            overflow-x: hidden;
            height: 100%;
            width: 100%;
        }

        .leftpart {
            padding: 20px;
            box-sizing: border-box;
            border-right: 1px solid #ccc;
            height: 100%;
        }

        .leftpart table {
            width: 100%;
        }

        .leftpart table tr td:first-child {
            width: 100px;
        }

        .leftpart tr td {
            padding: 5px;
        }

        .leftpart select {
            width: 260px;
        }

        .leftpart input[type=text] {
            width: 200px;
            display: inline-block;
        }

        .leftpart .control {
            margin-bottom: 10px;
        }

        .leftpart .control .control-label {
            display: inline-block;
            width: 60px;
            text-align: right;
        }

        .vtop {
            vertical-align: top;
        }
    </style>
</head>
<body>
    <div class="container-fluid " style="height: 100%;">
        <div class="row  " style="height: 100%;">
            <div class=" col-xs-6 leftpart">
                <table>
                    <tr>
                        <td>接口名称:</td>
                        <td>
                            <select class="form-control">
                                <option>登录</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td class="vtop">接口参数:</td>
                        <td>
                            <div class="param">
                                <div class="control">
                                    <label class="control-label">token</label>
                                    <input type="text" class="form-control" />
                                </div>
                                <div class="control">
                                    <label class="control-label">username</label>
                                    <input type="text" class="form-control" />
                                </div>
                                <div class="control">
                                    <label class="control-label">passwd</label>
                                    <input type="text" class="form-control" />
                                </div>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td></td>
                        <td>
                            <input type="button" value="发送" class="btn btn-primary " id="sendBtn" /></td>

                    </tr>
                </table>
                <table>
                    <tr>
                        <td class="vtop">地址：
                        </td>
                        <td>
                            <textarea class="form-control"></textarea>
                        </td>
                    </tr>
                    <tr>
                        <td class="vtop">参数：
                        </td>
                        <td>
                           <!-- <textarea class="form-control" rows="6" id="paramstxt"></textarea>-->
                            <pre id="pretxt">
                                 
                            </pre>
                        </td>
                    </tr>
                    <tr>
                        <td class="vtop">执行时间：
                        </td>
                        <td>
                            <textarea class="form-control"></textarea>
                        </td>
                    </tr>
                </table>


            </div>
            <div class=" col-xs-6">
                <pre id="result"></pre>
            </div>
        </div>
    </div>
</body>
</html>
<script src="js/jquery-1.9.1.min.js"></script>
<script type="text/javascript">
    $(function () {
        $("#sendBtn").click(function () {
            var param = {};
            $(".param .control").each(function () {
                var key = $.trim($(this).find("label").text());
                param[key] = $.trim($(this).find("input[type=text]").val());
            })
            alert(JSON.stringify(param));
            $("#paramstxt").val(JSON.stringify(param));
            //  var paramStr = JsonUti.converTostring(param);
            $("#paramstxt").val(JsonUti.convertToString(param));
            $("#pretxt").text(JsonUti.convertToString(param));

            //执行ajax返回数据
            var result = {
                id: "2155",
                name: "test1",
                mobile_phone: "test1",
                user_money: "1631.76",
                rank_name: "注册用户",
            };
            $("#result").text(JsonUti.convertToString(result));

        })
    })
    var JsonUti = {
        //定义换行符
        n: "\n",
        //定义制表符
        t: "\t",
        //转换String
        convertToString: function (obj) {
            return JsonUti.__writeObj(obj, 1);
        },
        //写对象
        __writeObj: function (obj    //对象
                , level             //层次（基数为1）
                , isInArray) {       //此对象是否在一个集合内
            //如果为空，直接输出null
            if (obj == null) {
                return "null";
            }
            //为普通类型，直接输出值
            if (obj.constructor == Number || obj.constructor == Date || obj.constructor == String || obj.constructor == Boolean) {
                var v = obj.toString();
                var tab = isInArray ? JsonUti.__repeatStr(JsonUti.t, level - 1) : "";
                if (obj.constructor == String || obj.constructor == Date) {
                    //时间格式化只是单纯输出字符串，而不是Date对象
                    return tab + ("\"" + v + "\"");
                }
                else if (obj.constructor == Boolean) {
                    return tab + v.toLowerCase();
                }
                else {
                    return tab + (v);
                }
            }

            //写Json对象，缓存字符串
            var currentObjStrings = [];
            //遍历属性
            for (var name in obj) {
                var temp = [];
                //格式化Tab
                var paddingTab = JsonUti.__repeatStr(JsonUti.t, level);
                temp.push(paddingTab);
                //写出属性名
                temp.push(name + " : ");

                var val = obj[name];
                if (val == null) {
                    temp.push("null");
                }
                else {
                    var c = val.constructor;

                    if (c == Array) { //如果为集合，循环内部对象
                        temp.push(JsonUti.n + paddingTab + "[" + JsonUti.n);
                        var levelUp = level + 2;    //层级+2

                        var tempArrValue = [];      //集合元素相关字符串缓存片段
                        for (var i = 0; i < val.length; i++) {
                            //递归写对象                         
                            tempArrValue.push(JsonUti.__writeObj(val[i], levelUp, true));
                        }

                        temp.push(tempArrValue.join("," + JsonUti.n));
                        temp.push(JsonUti.n + paddingTab + "]");
                    }
                    else if (c == Function) {
                        temp.push("[Function]");
                    }
                    else {
                        //递归写对象
                        temp.push(JsonUti.__writeObj(val, level + 1));
                    }
                }
                //加入当前对象“属性”字符串
                currentObjStrings.push(temp.join(""));
            }
            return (level > 1 && !isInArray ? JsonUti.n : "")                       //如果Json对象是内部，就要换行格式化
                + JsonUti.__repeatStr(JsonUti.t, level - 1) + "{" + JsonUti.n     //加层次Tab格式化
                + currentObjStrings.join("," + JsonUti.n)                       //串联所有属性值
                + JsonUti.n + JsonUti.__repeatStr(JsonUti.t, level - 1) + "}";   //封闭对象
        },
        __isArray: function (obj) {
            if (obj) {
                return obj.constructor == Array;
            }
            return false;
        },
        __repeatStr: function (str, times) {
            var newStr = [];
            if (times > 0) {
                for (var i = 0; i < times; i++) {
                    newStr.push(str);
                }
            }
            return newStr.join("");
        }
    };

</script>
